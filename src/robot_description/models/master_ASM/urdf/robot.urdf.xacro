<?xml version="1.0" encoding="utf-8"?>

<robot name="robot" xmlns:xacro="http://www.ros.org/wiki/xacro">

    <xacro:property name="chassisHeight" value="0.64"/>
    <xacro:property name="chassisLength" value="1.1"/>
    <xacro:property name="chassisWidth" value="0.512"/>
    <xacro:property name="chassisMass" value="55"/>
    <xacro:property name="wheelWidth" value="0.11"/>
    <xacro:property name="wheelRadius" value="0.15"/>
    <xacro:property name="wheelMass" value="2"/>

    <xacro:property name="pretty" value="true"/>

    <xacro:include filename="macros.urdf.xacro" />


    <link name="base_link">
        <origin xyz="0 0 0" rpy="0 0 0" />
    </link>

    <joint name="base_to_frame_joint" type="fixed">
        <parent link="base_link" />
        <child link="frame_link" />
        <origin xyz="0 0 0" rpy="0 0 -1.5708" />
    </joint>

    <link name="frame_link">
        <inertial>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <mass value="${chassisMass}" />
        <inertia
            ixx="0.51975"
            ixy="0"
            ixz="0"
            iyy="0.93889"
            iyz="0"
            izz="0.5273" />
        </inertial>
        <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <xacro:if value="${pretty}">
                <mesh
                filename="package://robot_description/models/master_ASM/meshes/frame_link.STL" />
            </xacro:if>
            <xacro:unless value="${pretty}">
                <box size="${chassisWidth} ${chassisLength} ${chassisHeight}"/>
            </xacro:unless>
        </geometry>
        <material
            name="">
            <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
        </visual>
        <collision>
        <origin
            xyz="0 0 -0.2"
            rpy="0 0 0" />
        <geometry>
            <box size="0.7317 1.4254 0.6435" />
        </geometry>
        </collision>
    </link>

    <link name="wheel1_Link">
        <inertial>
        <origin
            xyz="0 -0.115 0"
            rpy="0 0 0" />
        <mass
            value="1.1372" />
        <inertia
            ixx="0.0059462"
            ixy="0"
            ixz="0"
            iyy="0.0059468"
            iyz="0"
            izz="0.0072591" />
        </inertial>
        <visual>
        <origin
            xyz="0 0.115 0"
            rpy="0 0 0" />
        <geometry>
            <mesh
            filename="package://robot_description/models/master_ASM/meshes/wheel_Link.STL" />
        </geometry>
        <material
            name="">
            <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
        </visual>
        <collision>
        <origin
            xyz="0 0 0"
            rpy="0 0 0" />
        <geometry>
            <cylinder radius="0.115" length="0.2" />
        </geometry>
        </collision>
    </link>

    <joint
        name="wheel1_joint"
        type="continuous">
        <origin
        xyz="0 0 0"
        rpy="1.5708 0.34561 1.5708" />
        <parent link="frame_link" />
        <child link="wheel1_Link" />
        <axis
        xyz="0 0 -1" />
    </joint>
    
    <link name="wheel2_Link">
        <inertial>
        <origin
            xyz="0 -0.115 0"
            rpy="0 0 0" />
        <mass
            value="1.1372" />
        <inertia
            ixx="0.0059462"
            ixy="0"
            ixz="0"
            iyy="0.0059468"
            iyz="0"
            izz="0.0072591" />
        </inertial>
        <visual>
        <origin
            xyz="0 0.115 0"
            rpy="0 0 0" />
        <geometry>
            <mesh
            filename="package://robot_description/models/master_ASM/meshes/wheel_Link.STL" />
        </geometry>
        <material
            name="">
            <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
        </visual>
        <collision>
        <origin
            xyz="0 0 0"
            rpy="0 0 0" />
        <geometry>
            <!-- <mesh
            filename="package://Master_ASM/meshes/wheel2_Link.STL" /> -->
            <cylinder radius="0.115" length="0.2" />
        </geometry>
        </collision>
    </link>

    <joint name="wheel2_joint"
        type="continuous">
        <origin
        xyz="0 0 0"
        rpy="1.5708 0.34561 1.5708" />
        <parent
        link="frame_link" />
        <child
        link="wheel2_Link" />
        <axis
        xyz="0 0 1" />
    </joint>

    
    <link name="wheel3_Link">
        <inertial>
        <origin
            xyz="0 -0.115 0"
            rpy="0 0 0" />
        <mass
            value= "${wheelMass}" />
        <inertia
            ixx="0.0059462"
            ixy="0"
            ixz="0"
            iyy="0.0059468"
            iyz="0"
            izz="0.0072591" />
        </inertial>
        <visual>
        <origin
            xyz="0 0.115 0"
            rpy="0 0 0" />
        <geometry>
            <mesh
            filename="package://robot_description/models/master_ASM/meshes/wheel_Link.STL" />
        </geometry>
        <material
            name="">
            <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
        </visual>
        <collision>
        <origin
            xyz="0 0 0"
            rpy="0 0 0" />
        <geometry>
            <cylinder radius="0.115" length="0.2" />
        </geometry>
        </collision>
    </link>

    <joint
        name="wheel3_joint"
        type="continuous">
        <origin
        xyz="0 0 0"
        rpy="1.5708 0.34561 1.5708" />
        <parent
        link="frame_link" />
        <child
        link="wheel3_Link" />
        <axis
        xyz="0 0 1" />
    </joint>
    
    <link name="wheel4_Link">
        <inertial>
        <origin
            xyz="2.9097E-09 -0.115 -0.00055956"
            rpy="0 0 0" />
        <mass
            value="1.1372" />
        <inertia
            ixx="0.0059462"
            ixy="1.6529E-09"
            ixz="-6.3363E-10"
            iyy="0.0059468"
            iyz="6.9163E-09"
            izz="0.0072591" />
        </inertial>
        <visual>
        <origin
            xyz="0 0.115 0"
            rpy="0 0 0" />
        <geometry>
            <mesh
            filename="package://robot_description/models/master_ASM/meshes/wheel_Link.STL" />
        </geometry>
        <material
            name="">
            <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
        </visual>
        <collision>
        <origin
            xyz="0 0 0"
            rpy="0 0 0" />
        <geometry>
            <cylinder radius="0.115" length="0.2" />
        </geometry>
        </collision>
    </link>

    <joint name="wheel4_joint"
        type="continuous">
        <origin
        xyz="0 0 0"
        rpy="1.5708 0.34561 1.5708" />
        <parent
        link="frame_link" />
        <child
        link="wheel4_Link" />
        <axis
        xyz="0 0 -1" />
    </joint>

    <gazebo>
        <plugin
        filename="ignition-gazebo-joint-state-publisher-system"
        name="ignition::gazebo::systems::JointStatePublisher">
        <topic>joint_states</topic>
        </plugin>

        <plugin
        filename="ignition-gazebo-joint-controller-system"
        name="ignition::gazebo::systems::JointController">
        <joint_name>wheel1_joint</joint_name>
        <initial_velocity>0.0</initial_velocity>
        </plugin>

        <plugin
        filename="ignition-gazebo-joint-controller-system"
        name="ignition::gazebo::systems::JointController">
        <joint_name>wheel2_joint</joint_name>
        <initial_velocity>0.0</initial_velocity>
        </plugin>

        <plugin
        filename="ignition-gazebo-joint-controller-system"
        name="ignition::gazebo::systems::JointController">
        <joint_name>wheel3_joint</joint_name>
        <initial_velocity>0.0</initial_velocity>
        </plugin>

        <plugin
        filename="ignition-gazebo-joint-controller-system"
        name="ignition::gazebo::systems::JointController">
        <joint_name>wheel4_joint</joint_name>
        <initial_velocity>0.0</initial_velocity>
        </plugin>
    </gazebo>

</robot>